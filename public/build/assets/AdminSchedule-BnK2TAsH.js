import{f as o,o as r,a as h,b as e,w as v,e as S,F as _,A as L,r as x,m as H,l as O,g as G,u as K,Z as R,t as c,s as D,n as U,G as Z,h as q,d as J,y as Q,z as X,a0 as C}from"./app-Da_q7YT1.js";import{a as I,_ as V,b as ee}from"./Card-Ce8TQ4JY.js";import{_ as te}from"./GoBackNavLink-DlzU94TP.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ae={class:"space-x-8 rtl:space-x-reverse sm:flex"},le={__name:"ScheduleTabs",setup(A){return(f,k)=>(r(),o(_,null,[h(te),e("div",ae,[h(I,{href:f.route("schedule.admin"),active:f.route().current("schedule.admin")},{default:v(()=>[...k[0]||(k[0]=[S(" Schedule ",-1)])]),_:1},8,["href","active"])])],64))}},oe={class:"py-6"},re={class:"max-w-5xl mx-auto sm:px-4 lg:px-6"},ne={class:"flex justify-between items-center px-2"},ie={class:"font-bold text-lg text-white tracking-wide text-center"},de={class:"px-2 pb-4 overflow-x-auto"},ce={class:"w-full border-separate border-spacing-y-2"},ue={class:"py-2 px-2 align-middle"},fe={class:"w-full h-16 flex flex-col items-center justify-center rounded-xl transition-all duration-300 bg-white/5 border border-white/5 text-gray-200 group-hover:bg-white/10 group-hover:border-white/20",style:{width:"100px"}},he={class:"text-xs font-bold uppercase text-red-400"},xe={class:"text-xl font-bold"},pe=["onClick","title"],ve={key:0,class:"flex items-center justify-center w-full h-full px-3"},me={class:"text-white font-semibold text-xs text-center line-clamp-2 leading-tight break-words max-w-full"},be={key:1,class:"flex flex-col items-center justify-center w-full h-full"},ge={class:"flex justify-end mt-8 border-t border-white/10 pt-6"},we=["disabled"],ye={class:"bg-gradient-to-b from-gray-800 to-gray-900 rounded-2xl shadow-2xl w-full max-w-sm relative animate-fadeIn border border-white/10 overflow-hidden"},_e={class:"px-6 pt-6 pb-4 border-b border-white/5 bg-white/[0.02]"},ke=["disabled"],Me={class:"flex items-center gap-3 mb-1"},Ye={class:"text-lg font-bold text-white"},De={class:"text-xs text-gray-400"},Ce={class:"p-6"},Se={key:0,class:"flex flex-col items-center justify-center py-8"},Ae={key:1},je={class:"relative"},Le=["disabled"],Ve=["value"],Ne={class:"px-6 pb-6 flex gap-3"},Be=["disabled"],ze=["disabled"],Pe={__name:"AdminSchedule",props:{staffList:{type:Array,default:()=>[]},leaveList:{type:Array,default:()=>[]}},setup(A){const f=A;console.log("staffList:",f.staffList);const k=["Morning","Night"],N=["morning","evening"],B=L().startOf("week").add(1,"day"),n=x(B),m=x(null),b=x(null),i=x(!1),u=x({}),g=x(""),w=x(!1);async function p(){const a=n.value.format("YYYY-MM-DD"),{data:t}=await C.get("/schedule/week",{params:{week_start:a}});u.value=t.assignments||{},w.value=t.submitted||!1}H(p),O(n,p);const z=G(()=>Array.from({length:7},(a,t)=>n.value.add(t,"day")));function P(a,t){m.value=a,b.value=t,u.value[a.format("YYYY-MM-DD")]||(u.value[a.format("YYYY-MM-DD")]=[null,null]),g.value=u.value[a.format("YYYY-MM-DD")][t]||""}function M(){i.value||(m.value=null,b.value=null)}async function $(){i.value=!0;const a=g.value,t=m.value.format("YYYY-MM-DD"),s=n.value.format("YYYY-MM-DD");if(f.leaveList&&f.leaveList.some(d=>d.user_id==a&&d.start_date<=t&&(!d.end_date||d.end_date>=t))){i.value=!1,alert("This staff is on leave for the selected day. Please pick another staff.");return}if((u.value[t]||[null,null]).includes(a)){i.value=!1,alert("This staff is already assigned to another shift on this day. Please pick another staff.");return}let l=0;for(const[d,E]of Object.entries(u.value))d>=s&&d<=L(s).add(6,"day").format("YYYY-MM-DD")&&E.includes(a)&&l++;if(l>=6){i.value=!1,alert("This staff is already assigned to 6 days in this week. Please pick another staff.");return}await C.post("/schedule/assign",{employee_id:a,shift_type:N[b.value],day:t}),await p(),i.value=!1,M()}function T(){n.value=n.value.subtract(1,"week"),p()}function F(){n.value=n.value.add(1,"week"),p()}function j(a,t){var l;const s=(l=u.value[a.format("YYYY-MM-DD")])==null?void 0:l[t],y=f.staffList.find(d=>d.id==s);return y?y.name:""}function Y(a,t){var s;return!!((s=u.value[a.format("YYYY-MM-DD")])!=null&&s[t])}async function W(){confirm("Are you sure you want to reset all assignments for this week?")&&(await C.post("/schedule/reset",{week_start:n.value.format("YYYY-MM-DD")}),u.value={},await p())}return(a,t)=>(r(),o(_,null,[h(K(R),{title:"Weekly Schedule"}),h(ee,null,{tabs:v(()=>[h(le)]),default:v(()=>[e("div",oe,[e("div",re,[h(V,{variant:"glass",class:"!mt-0"},{default:v(()=>[e("div",ne,[e("button",{onClick:T,class:"bg-white/5 border border-white/10 hover:bg-white/10 text-white px-6 py-2 rounded-full font-bold text-sm transition-all shadow-none"},c(a.__("Previous")),1),e("span",ie,c(n.value.format("MMM D, YYYY"))+" - "+c(n.value.add(6,"day").format("MMM D, YYYY")),1),e("button",{onClick:F,class:"bg-white/5 border border-white/10 hover:bg-white/10 text-white px-6 py-2 rounded-full font-bold text-sm transition-all shadow-none"},c(a.__("Next")),1)])]),_:1}),h(V,{variant:"glass",class:"mt-6"},{default:v(()=>[t[3]||(t[3]=e("div",{class:"mb-4 px-2"},[e("div",{class:"flex items-center gap-3 bg-gradient-to-r from-amber-500/10 to-orange-500/5 border border-amber-500/20 rounded-xl px-4 py-3"},[e("div",{class:"flex items-center justify-center w-8 h-8 rounded-full bg-amber-500/20 flex-shrink-0"},[e("svg",{class:"w-4 h-4 text-amber-400",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z","clip-rule":"evenodd"})])]),e("div",{class:"text-sm"},[e("span",{class:"text-amber-300 font-medium"},"Your Schedule:"),e("span",{class:"text-gray-300 ml-1"},"Mon – Fri, 9:00 AM – 5:00 PM"),e("span",{class:"text-gray-500 ml-1"},"• Excluded from shift assignments")])])],-1)),e("div",de,[e("table",ce,[t[2]||(t[2]=e("thead",null,[e("tr",null,[e("th",{class:"text-xs font-bold text-gray-400 uppercase tracking-widest py-4 px-4 text-left"}," Day "),e("th",{class:"text-xs font-bold text-gray-400 uppercase tracking-widest py-4 text-center"},[S(" Morning"),e("br"),e("span",{class:"text-[10px] text-gray-500"},"6:00 AM - 3:00 PM")]),e("th",{class:"text-xs font-bold text-gray-400 uppercase tracking-widest py-4 text-center"},[S(" Night"),e("br"),e("span",{class:"text-[10px] text-gray-500"},"3:00 PM - 12:00 AM")])])],-1)),e("tbody",null,[(r(!0),o(_,null,D(z.value,(s,y)=>(r(),o("tr",{key:y,class:"group"},[e("td",ue,[e("div",fe,[e("span",he,c(s.format("ddd")),1),e("span",xe,c(s.format("D")),1)])]),(r(),o(_,null,D([0,1],l=>e("td",{key:l,class:"py-2 px-2 align-middle"},[e("div",{class:U(["min-w-[180px] h-16 flex items-center justify-center rounded-xl transition-all duration-300 border cursor-pointer relative backdrop-blur-md",Y(s,l)?"bg-gradient-to-br from-green-500/20 to-emerald-900/40 border-green-500/30 hover:border-green-400/50 hover:shadow-lg hover:shadow-green-900/20":"bg-white/5 border-white/5 hover:bg-white/10 hover:border-white/20 text-gray-400",w.value?"opacity-50 cursor-not-allowed grayscale":""]),onClick:d=>w.value?null:P(s,l),title:Y(s,l)?j(s,l):"Click to assign staff"},[Y(s,l)?(r(),o("div",ve,[e("span",me,c(j(s,l)),1)])):(r(),o("div",be,[...t[1]||(t[1]=[e("span",{class:"text-2xl text-white/20 font-light mb-0 leading-none"},"+",-1),e("span",{class:"text-[10px] uppercase tracking-wider text-white/40 font-bold"},"Assign",-1)])]))],10,pe)])),64))]))),128))])]),e("div",ge,[e("button",{onClick:W,disabled:w.value,class:"px-6 py-2 rounded-full font-bold text-sm text-gray-400 hover:text-white hover:bg-white/5 transition-all disabled:opacity-50"}," Reset Week ",8,we)])])]),_:1}),h(Z,{name:"fade"},{default:v(()=>[m.value!==null&&b.value!==null&&!w.value?(r(),o("div",{key:0,class:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50",onClick:J(M,["self"])},[e("div",ye,[e("div",_e,[e("button",{onClick:M,class:"absolute top-4 right-4 w-8 h-8 flex items-center justify-center rounded-full bg-white/5 text-gray-400 hover:bg-white/10 hover:text-white transition-all",disabled:i.value},[...t[4]||(t[4]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,ke),e("div",Me,[t[5]||(t[5]=e("div",{class:"w-10 h-10 rounded-xl bg-red-500/10 flex items-center justify-center"},[e("svg",{class:"w-5 h-5 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})])],-1)),e("div",null,[e("h2",Ye,c(k[b.value])+" Shift ",1),e("p",De,c(m.value.format("dddd, MMMM D, YYYY")),1)])])]),e("div",Ce,[i.value?(r(),o("div",Se,[...t[6]||(t[6]=[e("svg",{class:"animate-spin h-8 w-8 text-red-500 mb-3",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})],-1),e("span",{class:"text-gray-400 font-medium text-sm"},"Validating...",-1)])])):(r(),o("div",Ae,[t[9]||(t[9]=e("label",{class:"block text-xs font-bold uppercase tracking-wider text-gray-400 mb-2"}," Select Staff Member ",-1)),e("div",je,[Q(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>g.value=s),class:"w-full bg-white/5 border border-white/10 text-gray-100 text-sm rounded-xl focus:ring-red-500 focus:border-red-500 block p-3 pr-10 appearance-none transition-all",disabled:i.value,autofocus:""},[t[7]||(t[7]=e("option",{value:"",class:"bg-gray-900"},"Choose staff...",-1)),(r(!0),o(_,null,D(f.staffList.filter(s=>s.id!==1),s=>(r(),o("option",{key:s.id,value:s.id,class:"bg-gray-900"},c(s.name),9,Ve))),128))],8,Le),[[X,g.value]]),t[8]||(t[8]=e("div",{class:"absolute inset-y-0 right-0 flex items-center px-3 pointer-events-none text-gray-500"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})])],-1))])]))]),e("div",Ne,[e("button",{onClick:M,disabled:i.value,class:"flex-1 px-4 py-3 rounded-xl font-semibold text-sm text-gray-300 bg-white/5 border border-white/10 hover:bg-white/10 hover:text-white transition-all disabled:opacity-50"}," Cancel ",8,Be),e("button",{onClick:$,disabled:i.value||!g.value,class:"flex-1 px-4 py-3 rounded-xl font-bold text-sm text-white bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 shadow-lg shadow-red-900/30 transition-all disabled:opacity-50 disabled:cursor-not-allowed"}," Assign Staff ",8,ze)])])])):q("",!0)]),_:1})])])]),_:1})],64))}},He=se(Pe,[["__scopeId","data-v-a57f326f"]]);export{He as default};
