import{c as T,a as b,o as m,b as t,d as k,t as o,n as p,T as B,r as j,e as Z,Q as M,w as I,f as u,u as e,_ as s,Z as E,g as y,h as g,i as w,j as F,k as x,F as N,l as P,m as q,v as L,N as R,p as $}from"./app-B0hmWrIt.js";import{_ as z}from"./AuthenticatedLayout-DVBZZxv2.js";import{o as S}from"./main-DVO7YeuA.js";import{_ as Q}from"./AttendanceTabs-hSrzwbR4.js";import{_ as W}from"./TextInput-D1YhGPMP.js";import{_ as D,a as Y}from"./InputLabel-VSMzGDSf.js";import{P as G}from"./PrimaryButton-CmODOEUR.js";import{_ as J}from"./Card-DGziJDZR.js";import{H as K}from"./HorizontalRule-dqgshUs7.js";import{a as V}from"./useAttendanceTypes-BqZGZlad.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./NavLink-TT7O-nR-.js";import"./GoBackNavLink-BUbZ5ERw.js";const X={class:"my-4"},ee={key:0,d:"M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"},te={key:1,d:"M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"},ae={class:"font-medium"},se={key:0},le=["innerHTML"],ne="currentColor",A={__name:"Notice",props:{type:{type:String,default:"info"},br:{type:Boolean,default:!1},bold:String,text:String},setup(n){const l=T(()=>{let _="flex items-center p-4 mb-4 text-sm rounded-lg";switch(n.type){case"danger":return _+" text-red-800 border border-red-300 bg-red-50 dark:text-red-400 dark:bg-gray-800 dark:border-red-800";case"success":return _+" text-green-800 border border-green-300 bg-green-50 dark:text-green-400 dark:bg-gray-800 dark:border-green-800";case"warning":return _+" text-yellow-800 border border-yellow-300 bg-yellow-50 dark:text-yellow-300 dark:bg-gray-800 dark:border-yellow-800";case"dark":return _+" text-gray-800 border border-gray-300 bg-gray-50 dark:text-gray-300 dark:bg-gray-800 dark:border-gray-600";default:return _+" text-blue-800 border border-blue-300 bg-blue-50 dark:text-blue-400 dark:bg-gray-800 dark:border-blue-800"}});return(_,f)=>(m(),b("div",X,[t("div",{class:p(l.value),role:"alert"},[(m(),b("svg",{class:"flex-shrink-0 inline w-4 h-4 ltr:mr-3 rtl:ml-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:ne,viewBox:"0 0 20 20"},[n.type==="danger"?(m(),b("path",ee)):(m(),b("path",te))])),f[0]||(f[0]=t("span",{class:"sr-only"},"Info",-1)),t("div",null,[t("span",ae,o(n.bold+" "),1),n.br?(m(),b("br",se)):k("",!0),t("span",{innerHTML:n.text},null,8,le)])],2)]))}},oe={class:"py-8"},re={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},de={class:"card-header !mb-1"},ie={class:"relative shadow-md sm:rounded-lg mt-8 overflow-x-scroll md:overflow-visible"},ce={class:"w-full text-sm text-left"},ue={class:"table-thead"},me={scope:"col",class:"px-6 py-3"},he={scope:"col",class:"px-6 py-3"},_e={scope:"col",class:"px-6 py-3"},pe={scope:"col",class:"px-6 py-3"},be={scope:"col",class:"px-6 py-3"},fe={scope:"row",class:"table-th"},ye={class:"hidden"},ge={class:"table-td w-40"},ke=["onUpdate:modelValue","disabled"],ve={value:"on_time",selected:""},we={value:"late"},xe={value:"missed"},Se={class:"table-td"},Ve={class:"table-td"},Ae={class:"table-td"},Te={class:"p-4 text-sm"},Me={class:"flex items-center justify-end mt-4"},qe={__name:"AttendanceCreate",props:{employees:Object,attendances:Object,dateParam:String,attendable:Boolean},setup(n){const l=n,_=T(()=>l.attendances!==null&&Array.isArray(l.attendances)&&l.attendances.length===l.employees.length),f=T(()=>l.attendances!==null&&Array.isArray(l.attendances)&&l.attendances.length>0&&l.attendances.length<l.employees.length),a=B({date:j(new Date(l.dateParam).toISOString().split("T")[0]),employee_id:[],status:[],sign_in_time:[],sign_off_time:[]}),C=()=>{a.post(route("attendances.store"),{preserveScroll:!0,onError:()=>{$().error(s("Error Taking Attendance"))},onSuccess:()=>{$().success(s("Attendance Taken Successfully"))}})};function H(){a.employee_id=Array.from({length:l.employees.length},(c,i)=>l.employees[i].id),a.status=Array(l.employees.length).fill("on_time"),a.sign_in_time=Array(l.employees.length).fill({hours:9,minutes:0,seconds:0}),a.sign_off_time=Array(l.employees.length).fill({hours:17,minutes:0,seconds:0})}function O(){let c=0;for(;;){for(let i=0;i<l.attendances.length;i++)if(l.attendances[i].user_id===l.employees[c].id){const r=l.attendances[i];if(a.status[c]=r.status,r.clock_in_time===null)a.sign_in_time[c]=null;else{const[d,h,v]=r.clock_in_time.split(":").map(Number);a.sign_in_time[c]={hours:d,minutes:h,seconds:v}}if(r.clock_out_time===null)a.sign_off_time[c]=null;else{const[d,h,v]=r.clock_out_time.split(":").map(Number);a.sign_off_time[c]={hours:d,minutes:h,seconds:v}}break}if(c++,c>=l.employees.length)break}}function U(c,i,r){if(c){if(!i.is_manually_filled[r]&&i.status[r]!=="missed")return"‚ö†Ô∏è";if(i.is_manually_filled[r])return i.sign_off_time[r]===null?"‚úçÔ∏è":"‚úÖ"}return""}return Z(()=>{Object.keys(M().props.errors).length&&alert(M().props.errors.term),H(),(_.value||f.value)&&O()}),I(()=>a.date,()=>{R.visit(route("attendances.create",{term:a.date.toISOString().split("T")[0]}),{preserveState:!1,preserveScroll:!0})}),(c,i)=>(m(),b(N,null,[u(e(E),{title:e(s)("Take Attendance")},null,8,["title"]),u(z,null,{tabs:y(()=>[u(Q)]),default:y(()=>[t("div",oe,[t("div",re,[u(J,{class:"!mt-0"},{default:y(()=>[t("h1",de,o(e(s)("Take/Edit Attendance")),1),f.value?(m(),g(D,{key:0,class:"!font-thin"},{default:y(()=>[w(o(e(s)("Note: This page overwrites employees manually registered attendance"))+". ",1)]),_:1})):k("",!0),t("form",{onSubmit:F(C,["prevent"]),class:"pt-4"},[t("div",null,[u(D,{for:"date",value:e(s)("Select Day")},null,8,["value"]),u(e(S),{id:"date",modelValue:e(a).date,"onUpdate:modelValue":i[0]||(i[0]=r=>e(a).date=r),class:p(["py-1 block w-full",{"border border-red-500":e(a).errors.date}]),placeholder:"Select Date...","enable-time-picker":!1,"max-date":new Date,dark:x("isDark").value,required:""},null,8,["modelValue","class","max-date","dark"]),u(Y,{class:"mt-2",message:e(a).errors.date},null,8,["message"])]),n.attendable?k("",!0):(m(),g(A,{key:0,type:"success",bold:e(s)("Off Day!"),text:e(s)("This day is off (Weekend or a Holiday). No attendance for this day")+". üéâ"},null,8,["bold","text"])),_.value?(m(),g(A,{key:1,type:"warning",bold:e(s)("Notice!"),text:e(s)("The selected day's attendance has been already taken. You are now editing the previously taken attendance.")},null,8,["bold","text"])):f.value?(m(),g(A,{key:2,type:"warning",bold:e(s)("Incomplete Attendance!"),br:"",text:e(s)("Some employees have taken their attendances here while others did not. Any changes you make in this page will overwrite the records here.")+"<br />"+e(s)("Records with the sign ‚úçÔ∏è denotes that this employee has taken their attendance but hasn't signed off yet (incomplete attendance).")+"<br />"+e(s)("Records with the sign ‚úÖ denotes that this employee has taken their attendance and has signed off (complete attendance).")+"<br />"},null,8,["bold","text"])):k("",!0),u(K,{class:"mt-6"}),t("div",ie,[t("table",ce,[t("thead",ue,[t("tr",null,[t("th",me,o(e(s)("Employee name (ID)")),1),t("th",he,o(e(s)("Status")),1),t("th",_e,o(e(s)("Sign In Time")),1),t("th",pe,o(e(s)("Sign Off Time")),1),t("th",be,o(e(s)("Notes?")),1)])]),t("tbody",null,[(m(!0),b(N,null,P(n.employees,(r,d)=>(m(),b("tr",{key:r.id,class:p(["table-tr",{"bg-gray-50":d%2===1}])},[t("th",fe,[w(o(r.name+" ("+r.id+")")+" "+o(U(f.value,e(a),d))+" ",1),t("span",ye,o(e(a).employee_id[d]=r.id),1)]),t("td",ge,[q(t("select",{"onUpdate:modelValue":h=>e(a).status[d]=h,class:p(["fancy-selector",{"opacity-75 cursor-not-allowed":!n.attendable}]),disabled:!n.attendable},[t("option",ve,o(e(V).on_time),1),t("option",we,o(e(V).late),1),t("option",xe,o(e(V).missed),1)],10,ke),[[L,e(a).status[d]]])]),t("td",Se,[u(e(S),{modelValue:e(a).sign_in_time[d],"onUpdate:modelValue":h=>e(a).sign_in_time[d]=h,class:p(["mt-1 block w-full",{"opacity-75 cursor-not-allowed":!n.attendable}]),placeholder:e(s)("Select Time..."),"time-picker":"","is-24":!1,required:"",dark:x("isDark").value,disabled:!n.attendable},null,8,["modelValue","onUpdate:modelValue","placeholder","dark","disabled","class"])]),t("td",Ve,[u(e(S),{modelValue:e(a).sign_off_time[d],"onUpdate:modelValue":h=>e(a).sign_off_time[d]=h,class:p(["mt-1 block w-full",{"opacity-75 cursor-not-allowed":!n.attendable}]),placeholder:e(s)("Select Time..."),"time-picker":"","is-24":!1,required:"",dark:x("isDark").value,disabled:!n.attendable},null,8,["modelValue","onUpdate:modelValue","placeholder","dark","disabled","class"])]),t("td",Ae,[u(W,{id:"notes",type:"text",class:p(["mt-1 block w-full",{"opacity-75 cursor-not-allowed":!n.attendable}]),modelValue:e(a).notes[d],"onUpdate:modelValue":h=>e(a).notes[d]=h,autocomplete:"off",placeholder:e(s)("Note..."),disabled:!n.attendable},null,8,["modelValue","onUpdate:modelValue","placeholder","disabled","class"])])],2))),128))])]),t("div",Te,[t("p",null,o(e(s)("‚ö†Ô∏è Means there this page has registered attendances recorded, but this record is not recorded and needs to be filled"))+".",1),t("p",null,o(e(s)("‚úçÔ∏è Means there this page has registered attendances recorded, and this record has been taken by employee, but hasn't signed off yet (incomplete attendance)"))+".",1),t("p",null,o(e(s)("‚úÖ Means there this page has registered attendances recorded, and this record's attendance has been fully taken by employee (complete attendance)"))+".",1)])]),t("div",Me,[u(G,{class:p(["ltr:ml-4 rtl:mr-4",{"opacity-25 cursor-not-allowed":e(a).processing||!n.attendable}]),disabled:e(a).processing||!n.attendable},{default:y(()=>[w(o(e(s)("Confirm Attendance")),1)]),_:1},8,["class","disabled"])])],32)]),_:1})])])]),_:1})],64))}};export{qe as default};
